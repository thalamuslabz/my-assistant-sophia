# AGENTS.md

This file guides agentic coding agents (AI assistants) operating in this repository.

## 1. Project Context & Status

**Project:** Desktop App v1 — Deep Operational Assistant  
**Type:** Local-only, desktop-first application with explicit trust guardrails.  
**Stack (Planned):** Tauri (Rust + Frontend), Local Runtime.  
**Current Phase:** Sprint 0 — Repo + Process Foundations (Planning & Documentation).

**CRITICAL RULE:** No application coding is permitted until the Sprint Plan is approved. See `planning/GATES.md`.

## 2. Build, Lint, & Test Commands

As the project is currently in the planning phase, typical build commands are not yet active. Agents must use the following commands for available artifacts:

### scripts/
- **Hash Test Results:**
  ```bash
  ./scripts/hash_test_results.sh <path-to-file>
  ```
  Use this to generate SHA256 hashes for test evidence files.

### Future Development (Tauri/Rust/Node)
*These commands will become active once implementation begins:*

- **Development Server:**
  ```bash
  npm run tauri dev
  ```
- **Build Production:**
  ```bash
  npm run tauri build
  ```
- **Run Single Test (Rust):**
  ```bash
  cargo test <test_name>
  ```
- **Run Single Test (Frontend):**
  ```bash
  npm run test -- -t "<test_name>"
  ```
- **Linting:**
  ```bash
  npm run lint
  cargo clippy
  ```

## 3. Workflow & Process

Agents must strictly adhere to the engineering gates defined in `planning/GATES.md`.

1.  **Read First:** Before generating code, read `planning/SPRINT_PLAN_v1.md` and related docs in `docs/`.
2.  **Update Plans:** If a decision changes, update `planning/DECISIONS.md` and `planning/CHANGELOG.md`.
3.  **Test Evidence:**
    - All test runs must be recorded in `test-evidence/`.
    - Use `templates/TEST_RUN_TEMPLATE.md`.
    - Hash the result using the script and log it in `planning/TEST_EVIDENCE_INDEX.md`.

## 4. Code Style & Conventions

### General Principles
- **Local-Only:** No network calls to external services unless explicitly authorized and user-approved.
- **Explicit Trust:** No hidden behaviors. Pause means pause.
- **Security:** BYOK encrypted at rest. Never log secrets.

### Documentation (Markdown)
- Use standard GitHub Flavored Markdown.
- Headers should be clear and hierarchical (#, ##, ###).
- Lists should be consistent.
- **Naming:** `UPPER_SNAKE_CASE.md` for major artifacts (e.g., `GATES.md`), `snake_case` or `kebab-case` for others.

### Shell Scripts (Bash)
- **Safety:** Always start with `set -euo pipefail`.
- **Portability:** Use `#!/usr/bin/env bash`.
- **Feedback:** Echo errors to stderr (`>&2`).

### Rust (Future)
- **Safety:** Avoid `unwrap()` and `expect()`. Use `?` operator or `match` for error handling.
- **Formatting:** Follow `rustfmt`.
- **Linting:** Zero warnings with `clippy`.
- **Async:** Use `tokio` (standard for Tauri).
- **Naming:** `snake_case` for functions/variables, `PascalCase` for types.

### TypeScript / Frontend (Future)
- **Strictness:** `strict: true` in `tsconfig.json`. No `any`.
- **Framework:** React (implied by typical Tauri usage, confirm in plan).
- **State:** Explicit state machines preferred over loose boolean flags.
- **Formatting:** Prettier default settings.

## 5. Error Handling Patterns

### Application Errors
- **Fail Fast:** If state is invalid, halt the specific operation and log the error.
- **User Visibility:** Errors requiring user action must be surfaced in the UI.
- **Logging:** Log all errors to the local audit log (schema to be defined in Sprint 1).

### Script Errors
- Exit immediately on failure (`set -e`).
- Provide clear usage instructions if arguments are missing.

## 6. Directory Structure

- `/docs`: Source of truth for product requirements.
- `/planning`: Project management (Sprint plans, Risks, Gates).
- `/scripts`: Utility scripts for dev/test.
- `/templates`: Standardized templates for evidence.
- `/test-evidence`: Immutable records of test execution.

## 7. Interaction Guidelines for Agents

- **Ambiguity:** If a requirement is missing in `docs/` or `planning/`, ASK the user. Do not invent requirements.
- **Modification:** When modifying `planning/` files, append new entries rather than rewriting history, unless correcting a clear typo.
- **Verification:** After writing a script or doc, verify it exists and content is correct using `ls` and `read`.

---
*Generated by Agent for Agents.*
